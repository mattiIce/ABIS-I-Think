$PBExportHeader$f_validate_a_to_z_and_dash.srf
global type f_validate_a_to_z_and_dash from function_object
end type

forward prototypes
global function boolean f_validate_a_to_z_and_dash (string as_string_in, ref string as_offending_characters)
end prototypes

global function boolean f_validate_a_to_z_and_dash (string as_string_in, ref string as_offending_characters);//Alex Gerlants. 11/07/2016. Begin
/*
Function:	f_validate_a_to_z_and_dash
				ASCII between 65 and 90 are A to Z
				ASCII between 97 and 122 are a to z
				ASCII 150 is En dash
				ASCII 151 is Em dash
				ASCII between 48 and 57 are 0 to 9
Returns:		boolean	<== True if as_string_in has characters A to Z, a to z, and "-" (dash)
Arguments:	value			string	as_string_in
				reference	string	as_offending_characters <== List of invalid characters
*/

Boolean	lb_rtn = True
Integer	li_ascii_value
Long		ll_length, ll_i
String	ls_character

ll_length = Len(as_string_in)

For ll_i = 1 To ll_length
	ls_character = Mid(as_string_in, ll_i, 1)
	li_ascii_value = asc(ls_character)
	
	If 	(li_ascii_value >= 65 And li_ascii_value <= 90)		&
		Or (li_ascii_value >= 97 And li_ascii_value <= 122)	&
		Or	(li_ascii_value >= 150 And li_ascii_value <= 151)	&
		Or (li_ascii_value >= 48 And li_ascii_value <= 57)		Then //Valid characters
			//
	Else //Invalid characters
		lb_rtn = False
		If li_ascii_value = 32 Then //Space
			ls_character = "Space"
		End If
		
		as_offending_characters = as_offending_characters + ls_character + ", "
	End If
Next

If as_offending_characters <> "" Then
	//Remove the last comma
	as_offending_characters = Left(as_offending_characters, Len(as_offending_characters) - 2)
End If

Return lb_rtn
//Alex Gerlants. 11/07/2016. End
end function

